<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estudo Personalizado | Simulados de Enfermagem</title>
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Nunito+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <!-- CSS Externos -->
    <link rel="stylesheet" href="https://auditeduca.github.io/Calculadoras-de-Enfermagem/assets/css/variables-v4.css">
    <link rel="stylesheet" href="https://auditeduca.github.io/Calculadoras-de-Enfermagem/assets/css/header-v4.css">
    <link rel="stylesheet" href="https://auditeduca.github.io/Calculadoras-de-Enfermagem/assets/css/accessibility-v4.css">
    <link rel="stylesheet" href="https://auditeduca.github.io/Calculadoras-de-Enfermagem/assets/css/footer-v4.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #1A3E74;
            --accent: #00bcd4;
            --success: #4caf50;
            --warning: #ff9800;
            --error: #f44336;
            --light: #f4f6f9;
            --dark: #1f2937;
            --border: #e2e8f0;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--light);
            color: var(--dark);
            line-height: 1.6;
        }

        main {
            min-height: calc(100vh - 200px);
            padding: 40px 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        .page-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .page-header h1 {
            font-family: 'Nunito Sans', sans-serif;
            font-size: 32px;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 8px;
        }

        .page-header p {
            font-size: 16px;
            color: #666;
        }

        .settings-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .setting-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .setting-card h2 {
            font-family: 'Nunito Sans', sans-serif;
            font-size: 18px;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .setting-card i {
            color: var(--primary);
            font-size: 20px;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-group label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 8px;
        }

        .form-group select,
        .form-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-group select:focus,
        .form-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(26, 62, 116, 0.1);
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: var(--primary);
        }

        .checkbox-item label {
            margin: 0;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
        }

        .selected-count {
            font-size: 12px;
            color: #999;
            margin-top: 8px;
        }

        .action-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-top: 40px;
        }

        .btn {
            padding: 14px 32px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: #0d2a52;
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(26, 62, 116, 0.3);
        }

        .btn-secondary {
            background: var(--border);
            color: var(--dark);
        }

        .btn-secondary:hover {
            background: #d1d5db;
        }

        .preview-card {
            background: linear-gradient(135deg, var(--primary) 0%, #0d2a52 100%);
            color: white;
            border-radius: 12px;
            padding: 24px;
            text-align: center;
        }

        .preview-card h3 {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 8px;
        }

        .preview-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 16px;
        }

        .preview-details {
            font-size: 13px;
            opacity: 0.8;
            line-height: 1.8;
        }

        /* Responsivo */
        @media (max-width: 768px) {
            .settings-grid {
                grid-template-columns: 1fr;
            }

            .checkbox-group {
                grid-template-columns: 1fr;
            }

            .page-header h1 {
                font-size: 24px;
            }

            .action-buttons {
                flex-direction: column;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }

            main {
                padding: 20px 16px;
            }
        }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link" style="position: absolute; top: -40px; left: 0; background: var(--primary); color: white; padding: 8px; z-index: 100000;">Pular para conteúdo principal</a>
    
    <!-- Accessibility Container -->
    <div id="accessibility-container"></div>

    <!-- Header Container -->
    <header id="header-container"></header>

    <!-- Main Content -->
    <main id="main-content">
        <div class="container">
            <!-- Page Header -->
            <div class="page-header">
                <h1><i class="fas fa-book"></i> Estudo Personalizado</h1>
                <p>Configure seu simulado de acordo com suas preferências</p>
            </div>

            <!-- Settings -->
            <div class="settings-grid">
                <!-- Quantidade de Questões -->
                <div class="setting-card">
                    <h2><i class="fas fa-list-ol"></i> Quantidade de Questões</h2>
                    <div class="form-group">
                        <label for="quantidade">Selecione a quantidade:</label>
                        <select id="quantidade">
                            <option value="5">5 questões</option>
                            <option value="10" selected>10 questões</option>
                            <option value="15">15 questões</option>
                            <option value="20">20 questões</option>
                            <option value="25">25 questões</option>
                            <option value="30">30 questões</option>
                        </select>
                    </div>
                </div>

                <!-- Dificuldade -->
                <div class="setting-card">
                    <h2><i class="fas fa-chart-line"></i> Nível de Dificuldade</h2>
                    <div class="form-group">
                        <label for="dificuldade">Selecione o nível:</label>
                        <select id="dificuldade">
                            <option value="todos" selected>Todos os níveis</option>
                            <option value="facil">Fácil</option>
                            <option value="medio">Médio</option>
                            <option value="dificil">Difícil</option>
                        </select>
                    </div>
                </div>

                <!-- Tópicos -->
                <div class="setting-card">
                    <h2><i class="fas fa-tags"></i> Tópicos</h2>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="topico-anatomia" value="anatomia" checked>
                            <label for="topico-anatomia">Anatomia</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="topico-farmacologia" value="farmacologia" checked>
                            <label for="topico-farmacologia">Farmacologia</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="topico-patologia" value="patologia" checked>
                            <label for="topico-patologia">Patologia</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="topico-fisiologia" value="fisiologia" checked>
                            <label for="topico-fisiologia">Fisiologia</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="topico-microbiologia" value="microbiologia" checked>
                            <label for="topico-microbiologia">Microbiologia</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="topico-saude-publica" value="saude-publica" checked>
                            <label for="topico-saude-publica">Saúde Pública</label>
                        </div>
                    </div>
                    <div class="selected-count" id="selected-count">6 tópicos selecionados</div>
                </div>

                <!-- Preview -->
                <div class="preview-card">
                    <h3>Seu Simulado</h3>
                    <div class="preview-value" id="preview-quantidade">10</div>
                    <div class="preview-details">
                        <div id="preview-dificuldade">Todos os níveis</div>
                        <div id="preview-topicos">6 tópicos</div>
                        <div style="margin-top: 12px; font-size: 12px; opacity: 0.7;">Tempo estimado: <span id="preview-tempo">15 min</span></div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <button class="btn btn-secondary" onclick="window.history.back()">
                    <i class="fas fa-arrow-left"></i> Voltar
                </button>
                <button class="btn btn-primary" id="btn-iniciar" onclick="EstudoPersonalizado.iniciar()">
                    <i class="fas fa-play"></i> Iniciar Estudo
                </button>
            </div>
        </div>
    </main>

    <!-- Footer Container -->
    <footer id="footer-container"></footer>

    <!-- QuizEngine -->
    <script src="quiz-engine.js"></script>

    <!-- Script Principal -->
    <script>
        const EstudoPersonalizado = {
            config: {
                quantidade: 10,
                dificuldade: 'todos',
                topicos: ['anatomia', 'farmacologia', 'patologia', 'fisiologia', 'microbiologia', 'saude-publica']
            },

            init() {
                this.setupEventListeners();
                this.atualizarPreview();
            },

            setupEventListeners() {
                // Quantidade
                document.getElementById('quantidade').addEventListener('change', (e) => {
                    this.config.quantidade = parseInt(e.target.value);
                    this.atualizarPreview();
                });

                // Dificuldade
                document.getElementById('dificuldade').addEventListener('change', (e) => {
                    this.config.dificuldade = e.target.value;
                    this.atualizarPreview();
                });

                // Tópicos
                document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                    checkbox.addEventListener('change', () => {
                        this.atualizarTopicos();
                        this.atualizarPreview();
                    });
                });
            },

            atualizarTopicos() {
                this.config.topicos = Array.from(document.querySelectorAll('input[type="checkbox"]:checked'))
                    .map(cb => cb.value);
            },

            atualizarPreview() {
                // Quantidade
                document.getElementById('preview-quantidade').textContent = this.config.quantidade;

                // Dificuldade
                const dificuldadeMap = {
                    'todos': 'Todos os níveis',
                    'facil': 'Nível Fácil',
                    'medio': 'Nível Médio',
                    'dificil': 'Nível Difícil'
                };
                document.getElementById('preview-dificuldade').textContent = dificuldadeMap[this.config.dificuldade];

                // Tópicos
                const countTopicos = this.config.topicos.length;
                document.getElementById('preview-topicos').textContent = `${countTopicos} tópico${countTopicos !== 1 ? 's' : ''}`;
                document.getElementById('selected-count').textContent = `${countTopicos} tópico${countTopicos !== 1 ? 's' : ''} selecionado${countTopicos !== 1 ? 's' : ''}`;

                // Tempo estimado
                const tempoEstimado = Math.ceil(this.config.quantidade * 1.5);
                document.getElementById('preview-tempo').textContent = `${tempoEstimado} min`;
            },

            iniciar() {
                // Validar seleção
                if (this.config.topicos.length === 0) {
                    alert('Selecione pelo menos um tópico!');
                    return;
                }

                // Inicializar QuizEngine
                QuizEngine.init('estudo', {
                    quantidade: this.config.quantidade,
                    dificuldade: this.config.dificuldade,
                    topicos: this.config.topicos
                });

                // Redirecionar para página de quiz
                window.location.href = 'quiz.html?tipo=estudo';
            }
        };

        // Carregar componentes modulares
        async function carregarComponentes() {
            try {
                const headerResponse = await fetch('https://auditeduca.github.io/Calculadoras-de-Enfermagem/assets/html/header-v4.html');
                const headerHTML = await headerResponse.text();
                document.getElementById('header-container').innerHTML = headerHTML;

                const footerResponse = await fetch('https://auditeduca.github.io/Calculadoras-de-Enfermagem/assets/html/footer-v4.html');
                const footerHTML = await footerResponse.text();
                document.getElementById('footer-container').innerHTML = footerHTML;

                const accessibilityResponse = await fetch('https://auditeduca.github.io/Calculadoras-de-Enfermagem/assets/html/accessibility-v4.html');
                const accessibilityHTML = await accessibilityResponse.text();
                document.getElementById('accessibility-container').innerHTML = accessibilityHTML;

                if (window.loadAccessibilityScripts) {
                    window.loadAccessibilityScripts();
                }
            } catch (error) {
                console.error('Erro ao carregar componentes:', error);
            }
        }

        // Inicializar
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                carregarComponentes();
                EstudoPersonalizado.init();
            });
        } else {
            carregarComponentes();
            EstudoPersonalizado.init();
        }
    </script>
</body>
</html>
